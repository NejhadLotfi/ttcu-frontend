<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نمایش پست ها</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Bitter:400,700">
    <!-- <link rel="stylesheet" href="/ttcu/public/Style.css"> -->
    <link rel="stylesheet" href="/ttcu/public/cssnew.css">
   <link rel="stylesheet" href="dropdown.css">   
   <link rel="stylesheet" href="/ttcu/public/darkmode/moon.css">
   <link rel="stylesheet" href="/ttcu/src/footer.css">
   <link rel=icon href="../../src/Logo/ttcu-icon.ico">
   <link rel="stylesheet" href="../../src/css/showpost.css">
   
   <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
   <link href="style10.css" rel="stylesheet" type="text/css">
   <script src="https://kit.fontawesome.com/fc383a6465.js" crossorigin="anonymous"></script>
   <script src="https://cdn.ckeditor.com/ckeditor5/11.0.1/classic/ckeditor.js"></script>

</head>

<body>
  <div class="grid-header">
    <div>
        <div class="header-dark">
            <div class="header" id="myHeader">  
                          <nav class="navbar navbar-dark navbar-expand-md navigation-clean-search">
                <div class="container"><img src="Icon.png"><a class="navbar-brand" href="#">TTCU </a>
                    
                
                    <button class="navbar-toggler" data-toggle="collapse" data-target="#navcol-1">
                        <span class="sr-only">Toggle navigation</span><span class="navbar-toggler-icon"></span></button>
                    <div class="collapse navbar-collapse" id="navcol-1">


                        <ul class="nav navbar-nav">
                            <li class="nav-item" role="presentation">  
                                <div class="moon" onclick="myFunction()" class= dark-mode ></div></li>

                            
        
    
                                <li class="nav-item" role="presentation"><a class="nav-link" href="index.html">خانه</a></li>
                                <li class="nav-item" role="presentation"><a class="nav-link" href="../Pages/about/about.html">درباره ما</a></li>
    
                                <li class="nav-item" role="presentation"><a class="nav-link" href="#">بلاگ</a></li>
    
                                <li class="nav-item" role="presentation"><a class="nav-link" href="../Pages/contact-us/contact.html">تماس باما</a></li>
    
                                <li class="dropdown"><a class="dropdown-toggle nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" href="#">منو </a>
                                <div class="dropdown-menu" role="menu"><a class="dropdown-item" role="presentation" href="#">First Item</a><a class="dropdown-item" role="presentation" href="#">Second Item</a><a class="dropdown-item" role="presentation" href="#">Third Item</a></div>
                         

                            </li>
                        </ul>





                        <form class="form-inline mr-auto" target="_self">  </form>
                          
                        <span class="navbar-text">
                            <a href="../userinfo/userinfo.html" ><img src="../../src/img/per.PNG"></a>

                        
                 
            </nav>
        </div>
    </div>
</div>
</div>


<!----->











<div class="grid-container">
  <div class="grid-img">
  
      <div class="row" style="align-content: center;">
          <div class="leftcolumn" id="posts">
          </div>
        
        
        
        
          <div class="rightcolumn">
        
            <div class="card" style="width:400px;text-align: center;">
              <h4>پیش نمایش پست ها</h4>
              <div class="fakeimg" id="top"></div>
            </div>
        
          </div>
        
  
      </div>
        
     
      <!---->
  
  </div>
  </div>








    







<!---->


<footer class="footer">
  <div class="footer-left col-md-4 col-sm-6">
    <p class="about" dir="rtl" style="text-align: right;">
      <a href="../../Pages/about/about.html"><span> درباره ما</span> </a>
      در این صفحه شرح داده می شود که سایت آن ها چه طور به مخاطبان کمک می کند و چطور به سؤالات آن ها پاسخ می دهد:
       «ما عمیقاً برای سؤالات شما ارزش قائلیم و سعی می کنیم به بهترین شکل ممکن به سؤالات شما پاسخ دهیم.» 
      بعد از آن توضیح داده شده است که چطور به سؤالات مخاطبان پاسخ داده می شود، مثلاً به مخاطبان قول داده
       است که در کمتر از ۱۲ ساعت یک جواب کوتاه دریافت کنند. همچنین این صفحه شامل یک اطلاعات تماس ساده و واضح، 
      دکمه های مربوط به لینک شبکه های اجتماعی، لینک های پیشنهادی و حتی یک لیست از مطالب اخیر بلاگ سایت است.

    </p>
    <div class="icons">
      <a href="#"><i class="fa fa-facebook"></i></a>
      <a href="#"><i class="fa fa-twitter"></i></a>
      <a href="#"><i class="fa fa-linkedin"></i></a>
      <a href="#"><i class="fa fa-google-plus"></i></a>
      <a href="#"><i class="fa fa-instagram"></i></a>
    </div>
  </div>
  <div class="footer-center col-md-4 col-sm-6">
    <div>
      <i class="fa fa-map-marker"></i>
      <p><span> Street name and number</span> تهران , ایران</p>
    </div>
    <div>
      <i class="fa fa-phone"></i>
      <p> (+98) 21 22 44 70 53</p>
    </div>
    <div>
      <i class="fa fa-envelope"></i>
      <p><a href="NezhadLotfi@protonmail.com"> office@ttcu.com</a></p>
    </div>
  </div>
  <div class="footer-right col-md-4 col-sm-6">
    <h2> TTCU<span> <img src="../../public/Icon.png"></span></h2>
    <p class="menu">
      <a href="../../public/index.html"> خانه</a> |
      <a href="../about/about.html"> درباره ما</a> |
      <a href="../guidepage/guide.html"> راهنما</a> |
      <a href="../contact-us/contact.html"> تماس با ما</a>
    </p>
    <p class="name"> SamFa &copy; 2021</p>
  </div>
</footer>


<script>
 
  function loadPosts(){
  var detailArr={};
  var uniMajor={};
  uniMajor["uni"]=window.localStorage.getItem('uni');
  uniMajor["major"]=window.localStorage.getItem('major');
  detailArr["uniMajor"]=uniMajor;
  
  var xmlhttp;
  if(window.XMLHttpRequest){
   xmlhttp=new XMLHttpRequest;
  }
  else{
      xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
  xmlhttp.onreadystatechange=respond;
  function respond (){
  if (xmlhttp.readyState == 4 && xmlhttp.status == 200){
    
    var response = JSON.parse(this.responseText);
      if(response.code == 200){
          console.log(response);
          let len = response.object.length;
          let text ="";
          let images="";
          if(len==0)
          {
            text="<div class=\"card\"><h6>پستی برای نمایش وجود ندارد</h6></div>"
          }else
          {
          for (let i = 0; i < len; i++) {
            var randomPic=choosePic(response.object[i].postType);
               text +=
               "<div id='post"+i+"' class='card'>"+
              
      "<br/>"+
                     "<h10>#" +convertPostType(response.object[i].postType) + "</h10>"+
                     "<h6 id=\"postId"+i+"\"> کد پست: "  + response.object[i].id +"</h6>"+
                     "<h6>"  + convertMajor(response.object[i].uniMajor.major) +"</h6>"+
                     "<h6>"  + convertUni(response.object[i].uniMajor.uni) +"</h6>" +
                     "<h2 id=\"textId"+i+"\"class=\"text\">"  + response.object[i].title +"</h2>" + 
                     "<h17>@" + response.object[i].username +"</h17>" +
                     "<h20>"  + convertUserType(response.object[i].userType) +"</h20>" +
                     "<div> <img  class=\"fakeimg\"   height='400' id='postImage' src='"+randomPic+"'> </div>" +
                     "<P class=\"text\">توضیحات:</P>" +
                     "<p class=\"text\">"  + response.object[i].description +"</p>" +
                     "<label class=\"text\"><p id=\"contact\">"+response.object[i].contact +"</p></label> "+
                     "<h6>تاریخ :"+response.object[i].pDate+"  "+response.object[i].pTime+"</h6></div>";
  
                images+="<a href=\"#post"+i+"\">"+response.object[i].title+"</a><br>";
              
              }}
            
              document.getElementById("posts").innerHTML = text;
              document.getElementById("top").innerHTML = images;
              
  
       
      }else {
        window.location = 'welcome.html';
  
      }
  
  }
  else if( xmlhttp.status == 403){
      window.location = '../../../login/login.html';
    
    } 
  else{
    console.log("Hello");
  
  }
  
  }
  
  
  xmlhttp.open('POST','http://127.0.0.1:8082/api/postInquiry',true);
  xmlhttp.setRequestHeader('Content-Type', 'application/json;charset=UTF-8');
  xmlhttp.setRequestHeader('Authorization',window.localStorage.getItem("Token"));
  
  xmlhttp.send(JSON.stringify(detailArr));
  }
  
  </script>

<script>
  loadUserInfo();
      function loadUserInfo(){
      var detailArr={};
      var xmlhttp;
      if(window.XMLHttpRequest){
       xmlhttp=new XMLHttpRequest;
      }
      else{
          xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
      }
      xmlhttp.onreadystatechange=respond;
      function respond (){
      console.log(xmlhttp.readyState);
      console.log(xmlhttp.status);
      if (xmlhttp.readyState == 4 && xmlhttp.status == 200){
        
        var response = JSON.parse(this.responseText);
          if(response.code == 200){
              console.log(response);
              var info = response.object;
              let uni =info.uniMajor.uni;
              let major=info.uniMajor.major;
             window.localStorage.setItem('uni',uni);
             window.localStorage.setItem('major',major);
              loadPosts();
              
          
           
          }else {
            window.location = 'welcome.html';
      
          }
          }
      
      else if( xmlhttp.status == 403){
      window.location = '../../../login/login.html';
    
    } else{
        console.log("Hello");
      
      }
      
      }
      
      
      xmlhttp.open('GET','http://127.0.0.1:8082/api/getUserInfo',true);
      xmlhttp.setRequestHeader('Content-Type', 'application/json;charset=UTF-8');
      xmlhttp.setRequestHeader('Authorization',window.localStorage.getItem("Token"));
      
      xmlhttp.send(JSON.stringify(detailArr));
      }
      
      </script>



<script>
 

    var myPix = new Array("1.jpg","2.jpg","3.jpg","4.jpg");

    function choosePic(postType) {
     var randomNum = Math.floor(Math.random() * myPix.length);
     return "../../../../src/img/post/"+postType+"/"+ myPix[randomNum];
    }
  </script>
<script src="../../src/app/enumConverter.js"></script>
<script src="../../public/darkmode/darkmod.js"></script>
<script src="../../src/app/showpost.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.bundle.min.js"></script>

</body>
</html>